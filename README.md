# Lem-in

**Lem-in** — учебный алгоритмический проект на Go, посвящённый работе с графами, поиску кратчайших путей и пошаговой симуляции.
Задача проекта — провести колонию муравьёв из стартовой комнаты в конечную по системе комнат и туннелей за минимальное количество ходов, соблюдая ограничения задачи.

---

## Постановка задачи

Во входном текстовом файле (`example00.txt`, …) описывается:

* количество муравьёв;
* список комнат с координатами;
* связи (туннели) между комнатами;
* директивы `##start` и `##end`.

Необходимо:

* корректно распарсить входные данные;
* найти набор **вершинно-непересекающихся** путей от старта к финишу;
* выбрать оптимальное количество путей, минимизирующее общее время прохождения;
* распределить муравьёв по путям;
* вывести пошаговую симуляцию их движения.

---

## Структура проекта

```text
.
├── main.go          // Точка входа
├── internal/
│   ├── lem/
│   │   └── run.go       // Связка парсер → солвер → симуляция
│   ├── parser/
│   │   └── parser.go    // Парсинг входных данных и валидация
│   ├── graph/
│   │   └── graph.go     // Граф
│   └── solver/
│       ├── paths.go     // Поиск и выбор оптимальных путей
│       ├── flow.go      // Реализация Edmonds–Karp
│       └── simulate.go  // Пошаговая симуляция движения муравьёв
```

---

## Парсинг входных данных

Файл `parser.go` отвечает за:

* чтение входного файла построчно;
* проверку корректности формата;
* валидацию:

  * положительное количество муравьёв;
  * наличие стартовой и конечной комнаты;
  * уникальность комнат;
  * отсутствие дубликатов связей;
  * корректность имён комнат;
* сохранение исходного ввода для последующего вывода без изменений.

При любой ошибке парсинга возвращается единая ошибка `invalid data format`.

---

## Представление графа

В `graph.go` реализован неориентированный граф:

* комнаты — вершины;
* туннели — рёбра;
* используется adjacency map для быстрого доступа;
* добавление рёбер автоматически создаёт обе стороны связи.

Граф не содержит логики поиска — он используется как базовая структура данных.

---

## Поиск путей

### Основной подход

Поиск реализован в `paths.go` и состоит из нескольких этапов:

1. Построение графа на основе входных данных.
2. Поиск **кратчайших вершинно-непересекающихся путей** с помощью BFS:

   * после нахождения пути все внутренние комнаты блокируются;
   * старт и финиш не блокируются.
3. Детерминированная сортировка путей:

   * сначала по длине;
   * затем лексикографически.
4. Выбор оптимального количества путей:

   * рассчитывается makespan для `k = 1..N`;
   * выбирается `k`, минимизирующее общее число ходов.

Алгоритм не использует случайность — при одинаковом вводе результат всегда одинаковый.

---

## Потоки и Edmonds–Karp

Файл `flow.go` содержит реализацию алгоритма **Edmonds–Karp**, используемого для поиска максимального потока в ориентированном графе.

В проекте он применяется для:

* node-splitting (каждая комната разбивается на `in → out`);
* ограничения пропускной способности вершин;
* извлечения вершинно-непересекающихся путей.

Реализация полностью самостоятельная, без сторонних библиотек.

---

## Симуляция движения муравьёв

Симуляция реализована в `simulate.go`.

Правила симуляции:

* за один ход муравей может переместиться только на одну комнату вперёд;
* в одной комнате (кроме start и end) может находиться только один муравей;
* муравьи запускаются на пути по принципу минимальной нагрузки;
* движение происходит пошагово, пока все муравьи не достигнут финиша.

Формат вывода каждого шага:

```text
L<antID>-<room>
```

Муравьи в строке сортируются по номеру.

Если на шаге невозможно сделать ни одного хода — симуляция завершается ошибкой.

---

## Связка компонентов

Файл `run.go` выполняет полный цикл:

1. чтение входного файла;
2. парсинг;
3. поиск оптимальных путей;
4. симуляция;
5. вывод:

   * исходной карты;
   * пустой строки;
   * строк с движениями муравьёв.

Исходный ввод **не модифицируется**.

---

## Запуск проекта

Запуск из корня проекта:

```bash
go run . example00.txt
```

Примеры корректных входных данных:

```bash
go run . example00.txt
go run . example01.txt
go run . example02.txt
go run . example03.txt
go run . example04.txt
go run . example05.txt
go run . example06.txt
go run . example07.txt
```

Примеры файлов с ошибками:

```bash
go run . badexample00.txt
go run . badexample01.txt
```

Примеры файлов со временем:

```bash
time go run . example01.txt
```

---

## Реализация

* все муравьи доходят до `##end`;
* ни одна комната не используется более чем одним муравьём за ход;
* каждый туннель используется не более одного раза за ход;
* результат стабилен при повторных запусках;
* соблюдены требования по времени выполнения и памяти;
* код разделён по зонам ответственности и соответствует best practices Go.
